{"code":"!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=4)}([function(e,t){e.exports=require(\"@tonaljs/midi\")},function(e,t){e.exports=require(\"animejs/lib/anime.es\")},function(e,t){e.exports=require(\"redis\")},function(e,t){e.exports=require(\"tone\")},function(e,t,n){\"use strict\";n.r(t);var o=n(2),r=n.n(o),s=n(1),l=n.n(s);var i={randomColorRGB:function(e,t,n){return`rgb(${Math.floor(256*Math.random())||e}, ${Math.floor(256*Math.random())||t}%, ${Math.floor(256*Math.random())||n}%)`},randomColorHSL:function(e,t,n){return`hsl(${Math.floor(256*Math.random())||e}, ${Math.floor(101*Math.random())||_sat}%, ${Math.floor(101*Math.random())||n}%)`},getNextColor:function(){const e=document.getElementById(\"pressed-color\").value;return\"random\"!==e?\"#\"+e:this.randomColorHSL()}},a=n(0);const c=document.getElementById(\"noteName\"),u=document.getElementById(\"visualizer\"),d=[];let f=null;const m={handleEvent:(e,t)=>(function(e,t){if(144===t[0]){const t=document.createElement(\"div\");if(t.style.display=\"inline-block\",t.style.position=\"absolute\",t.style.backgroundColor=\"blue\",t.style.height=\"auto\",t.style.top=u.getBoundingClientRect().height+\"px\",t.style.bottom=0,t.classList.add(\"currentlyPressed\"),t.classList.add(Object(a.midiToNoteName)(e.id)),\"white\"===e.className.baseVal){const o=document.getElementById(\"21\").getBoundingClientRect().width,r=[\"C\",\"D\",\"E\",\"F\",\"G\",\"A\",\"B\"],s=Object(a.midiToNoteName)(e.id);function n(){if(\"A0\"===s)return 0;if(\"B0\"===s)return 1.25*o;const e=s[0],t=s[1];let n=r.indexOf(e)*o+7*(t-1)*o+2*o;return[\"A\",\"B\",\"D\",\"E\",\"G\"].includes(e)&&(n+=o/4),n}const l=n();t.style.left=l+\"px\";let i=o;\"C8\"===s||(\"A0\"===s?i-=o/4:[\"B\",\"C\",\"E\",\"F\"].includes(s[0])?i-=o/4:i-=o/2),t.style.width=i+\"px\"}else{const o=document.getElementById(\"22\").getBoundingClientRect().width,r=Object(a.midiToNoteName)(e.id);function n(e){if(\"Bb0\"===e)return 1.5*o;if(\"Db1\"===e)return 5.5*o;if(\"Eb1\"===e)return 7.5*o;if(\"Gb1\"===e)return 11.5*o;if(\"Ab1\"===e)return 13.5*o;{let t=e[2];return\"B\"===e[0]&&t++,e=[\"D\",\"E\",\"G\",\"A\"].includes(e[0])?e[0]+e[1]+\"1\":e[0]+e[1]+\"0\",n(e)+14*parseInt(t-1,10)*o}}const s=n(r);t.style.left=s+\"px\",t.style.width=o+\"px\"}u.appendChild(t),d.push(Object(a.midiToNoteName)(e.id))}else if(128===t[0]){const t=u.querySelectorAll(`.currentlyPressed, .${Object(a.midiToNoteName)(e.id)}`);for(var o=0;o<t.length;o++)t[o].className.split(\" \").includes(\"currentlyPressed\")&&t[o].className.split(\" \").includes(Object(a.midiToNoteName)(e.id))&&t[o].classList.remove(\"currentlyPressed\");for(o=0;o<d.length;o++)if(d[o]===Object(a.midiToNoteName)(e.id)){d.splice(o,1);break}}c.innerHTML=d.join(\", \")||\"-\"})(e,t),start:()=>void(f=setInterval((function(){for(let e=0;e<u.children.length;e++){const t=u.children[e];let n=parseInt(t.style.top),o=parseInt(t.style.bottom);n>0&&n--,t.classList.contains(\"currentlyPressed\")||o++,t.style.top=n+\"px\",t.style.bottom=o+\"px\",parseInt(t.style.bottom,10)>=u.getBoundingClientRect().height&&t.remove()}}),10)),stop:()=>void clearInterval(f)};let y=null;const p=(e,t)=>{const n=document.getElementById(\"pressed-color\").value;e.style.fill=\"random\"!==n?\"#\"+n:i.randomColorHSL();try{m.handleEvent(e,t)}catch(e){console.log(e)}},g=(e,t)=>{\"white\"===e.className.baseVal?e.style.fill=\"white\":e.style.fill=\"black\";try{m.handleEvent(e,t)}catch(e){console.log(e)}};function h(e){Array.isArray(e)||(e=e.data);const t=e[0],n=e[1],o=document.getElementById(n+\"\");switch(t){case 144:p(o,e);break;case 128:g(o,e)}}function b(e){y=e,e.inputs.forEach((function(e){e.onmidimessage=h})),console.log(\"Obtained permission for MIDI access!\")}const v=e=>{console.log(\"Failed to get MIDI access - \"+e)};var I={setupKeys:()=>{document.getElementById(\"noteName\");const e=[];for(var t=21;t<=108;t++){const n=document.getElementById(t+\"\");n.onmouseenter=()=>{n.style.fill=i.getNextColor(),h([144,n.id,127])},n.onmouseleave=()=>{n.style.fill=n.classList.contains(\"white\")?\"white\":\"black\",h([128,n.id,0])},e.push(n),n.style.opacity=0,n.style.cursor=\"pointer\"}return e},animatePageLoad(e=null){l()({targets:\"#logo svg path\",strokeDashoffset:[l.a.setDashoffset,0],easing:\"easeInOutSine\",duration:1e3,delay:0}),l()({targets:\"#logo svg path\",\"fill-opacity\":1,easing:\"easeInOutSine\",duration:1e3,delay:0});const t=Array.from(document.querySelectorAll(\".white, .black\")).sort((function(e,t){return parseInt(e.id,10)-parseInt(t.id,10)}));l()({targets:t,opacity:1,delay:0,easing:\"easeInOutSine\",complete:e})}};const x=n(3);new x.PolySynth(4,x.Synth).toMaster();x.context.lookAhead=0,I.setupKeys(),I.animatePageLoad((function(){console.log(\"requesting midi access...\"),navigator.requestMIDIAccess({sysex:!0}).then(b,v),m.start()})),console.log(\"init done\");const M=r.a.createClient(6379,\"159.203.179.131\",{password:\"ChaMpvR8lXlVOCy0ZYDGTkg3WzG43zD7CD1xR66xhf/6jy9SLHUv9G6uXy64MW6gORsiQ1QcdIUTAvzt\"});console.log(M.get(\"home\"))}]);","extractedComments":[]}